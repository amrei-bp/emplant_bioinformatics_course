---
title: "Quality Control of Sequencing Data"
format: 
    closeread-html:
        cr-section:
            layout: "overlay-center"
        cr-style:
            section-background-color: "#ffffff"
---
<br>
By the end of this module, you should be able to:

1. Explain why QC of sequencing data is necessary.
2. Interpret FastQC reports and their warnings.
3. Decide what action (if any) to take based on QC results.

## From plant tissue to sequencing reads

Before we talk about quality control, it is important to understand how sequencing data is produced. Many of the problems we detect during QC originate early in the sequencing workflow.

At a high level, the process looks like this:

> Plant tissue → DNA extraction → Library preparation → Sequencing → FASTQ files

Each step can introduce technical effects that later appear in quality control reports. Let's have a closer look:

:::{.cr-section}

::: {#cr-sticky_sampling}
![](figures/qc/sampling.png)
:::

@cr-sticky_sampling We start with **plant tissue** and extract the contained DNA.  

::: {#cr-sticky_prep}
![](figures/qc/library_prep.png)
:::

@cr-sticky_prep Next, sequencing machines do not read whole chromosomes. Instead, DNA is broken into **many small fragments**, the so called **DNA library**.

::: {#cr-sticky_seq}
![](figures/qc/sequencing.png)
:::

@cr-sticky_seq The **DNA library** (with adapters added), is then run on a **sequencing machine**, which calls the bases of each fragment.

The final output are usually **FASTQ files**, which contain raw reads and quality scores.  
:::

## Why do we need quality control?

When we work with sequencing data, we usually want to answer a **biological question**.

In plant breeding, these could for example be:

- Which genetic variants are associated with a certain trait?
- Which alleles are present in a breeding line?
- How similar are two plant populations?
- Which genes are expressed under certain conditions?

All of these questions rely on the assumption that
**the sequencing data reflects the real biology of the plant.**

Quality control (QC) is the step where we check whether this assumption is reasonable.

As such, QC is not about making the data “look nice”. It is about making sure that **technical problems do not lead to wrong biological conclusions**.


## What can go wrong if data quality is poor?

Sequencing errors do not stay “technical”. They can directly affect how we interpret the biology:

| Technical issue                | Biological consequence    |
| --------------------- | ------------------------- |
| Low base quality | Identification of false SNPs                |
| Adapter contamination            | Detection of artificial variants       |
| GC bias                      | Skewed allele frequency estimates |
| High duplication           | Overconfidence in genotypes   |

<br> 
In a breeding context, this can mean that we might **choose the wrong markers**, **miss true marker-trait associations** or **misjudgement or genetiv diversity**.

Quality control helps us detect these problems *before* we trust the results.


## Where do sequencing errors come from?

Sequencing errors can be introduced at several steps, long before we ever see a FASTQ file.

### Step 1: DNA extraction

![](figures/qc/sampling.png)

Plant material can be challenging to work with. Different issuea can affect the quality of the reads that will be sequenced:

-  Compounds such as polyphenols and polysaccharides can interfere with enzymes or make the DNA sticky.
- DNA quality can vary strongly between samples, depending on the extraction method, tissue and extractor.



### Step 2: Library preparation

![](figures/qc/library_prep.png)

During library preparation, the DNA is sheared into fragments, adapters are ligated to these DNA fragments and the DNA is often amplified using PCR.

Sometimes, the DNA already degrades before the library preparation. That can lead to **uneven sequencing coverage** in the sequenced reads.

The **PCR can introduce a bias**, where some fragments are amplified more than others. 

All these effects are *technical*, but they **shape the data we later analyse**.


### Sequencing

![](figures/qc/sequencing.png)

Sequencing run itself can introduce errors. Base calling becomes less accurate toward the end of reads
- Errors accumulate across sequencing cycles
- Different lanes or runs can have different overall quality

This is why read quality often decreases from the 5′ end to the 3′ end of a read.



## Why plant genomes are special

Many QC tools are **generic**. They do not “know” that your data comes from plants.

However, plant genomes often have features that affect QC results:

- Large genome sizes
- High repeat content
- Polyploidy
- High heterozygosity
- Variable GC content between species

Because of this:

- GC content plots may look unusual even for good data.
- High duplication levels are not always a technical problem.
- Some warnings are expected and acceptable.

This means that **QC results must always be interpreted in a biological context**.

Quality control tools can show you *what* looks unusual —  you need biological knowledge to decide *why*.


## What is FastQC?

FastQC is a tool that summarises raw sequencing data and provides a set of diagnostic plots and tests.

FastQC works on **raw FASTQ files**, examines millions of reads quickly and produces an **easy-to-read report**.

FastQC does **not**:

- Correct errors
- Remove low-quality data
- Decide whether data is “good enough”

FastQC only provides information, the **interpretation and decisions are up to you.**
